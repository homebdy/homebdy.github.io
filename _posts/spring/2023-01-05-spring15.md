---
layout: post
title:  "Spring Data JPA"
author: yj
category: [ Springπ± ]
tags: [ JAVA, SPRING ]
---

### <a href="#">JPQL</a>
JPAμ—μ„ μ‚¬μ©ν•  μ  μλ” μΏΌλ¦¬

**μΏΌλ¦¬ λ©”μ„λ“**

1. μƒμ„±
    ```
    List<Person> findByLastnameAndEmail(String lastName, String email)
    ```
    - μΏΌλ¦¬ λ©”μ„λ“λ” λ™μ‘μ„ κ²°μ •ν•λ”μ£Όμ²΄μ™€ μ„μ μ–΄λ΅ κµ¬λ¶„

2. ν‚¤μ›λ“

**μ£Όμ  ν‚¤μ›λ“**
    - find~By: λ°μ΄ν„° μ΅°ν 
    - exit~By: νΉμ • λ°μ΄ν„° μ΅΄μ¬ ν™•μΈ
    - count~By: λ μ½”λ“ κ°μ λ°ν™
    - delet~By: μ‚­μ  μΏΌλ¦¬ μν–‰

**μ΅°κ±΄μ ν‚¤μ›λ“**
    - Is: κ°’μ μΌμΉ ν™•μΈ
    - Not: κ°’μ λ¶μΌμΉ ν™•μΈ
    - Null: κ°’μ΄ λ„κ°’μΈμ§€ ν™•μΈ
    - GreaterThan~: λΉ„κµ μ—°μ‚°

### <a href="#">μ •λ ¬κ³Ό νμ΄μ§• μ²λ¦¬</a>

**μ •λ ¬ μ²λ¦¬**
- ORDER BY: μ •λ ¬ κΈ°λ¥ ν‚¤μ›λ“
    ```
    // μƒν’ μ •λ³΄λ¥Ό μ΄λ¦„μΌλ΅ κ²€μƒ‰ν• ν›„ μƒν’ λ²νΈλ΅ μ¤λ¦„μ°¨μ μ •λ ¬
    List<Product> findByNameOrderByNumberAsc(String name);
    List<Product> findByNameOrderByNumberDesc(String name); 
    ```
- λ§¤κ°λ³€μλ¥Ό μ΄μ©ν• μ •λ ¬
    ```
    List<Product> findByName(String name, Sort sort);
    ```
    Sortκ°μ²΄λ¥Ό μ΄μ©ν•΄ μΏΌλ¦¬λ¬Έ μ‘μ„±

**νμ΄μ§• μ²λ¦¬**

λ°μ΄ν„°λ² μ΄μ¤μ λ μ½”λ“λ¥Ό κ°μλ΅ λ‚λ  νμ΄μ§€λ¥Ό κµ¬λ¶„ν•λ” κ²ƒ
- Page λλ” Pageable μ‚¬μ©
    ```
    Page<Product> findByName(String name, Pageable pageable);
    ```
    - λ¦¬ν„΄ νƒ€μ…: Page, λ§¤κ°λ³€μ: Pageable νƒ€μ… κ°μ²΄
- PageRequest: ofλ©”μ„λ“λ¥Ό ν†µν•΄ μƒμ„±
- of λ©”μ„λ“
    1. of(int page, int size): νμ΄μ§€: νμ΄μ§€λ‹Ή λ°μ΄ν„° κ°μ
    2. of(int page, int size, Sort): + μ •λ ¬
    3. of(int page, int size, Direction, String ...): +μ •λ ¬ λ°©ν–¥, μ†μ„±


### <a href="#">@Query μ–΄λ…Έν…μ΄μ…</a>
- μ§μ ‘ JPQLμ„ μ‘μ„±ν•λ” μ–΄λ…Έν…μ΄μ…
- νλ‹λ μΏΌλ¦¬λ¥Ό μ‚¬μ©ν•κ³ μ ν•  λ• μ‚¬μ©ν•λ” λ°©μ‹
    ```
    @Query("SELECT p FROM Product p WHERE p.name = :name")
    List<Product> findByName(@Param("name") String name);
    ```


### <a href="#">QueryDSL</a>
- λ¬Έμμ—΄μ΄ μ•„λ‹ μ½”λ“λ΅ μΏΌλ¦¬λ¥Ό μ‘μ„±ν•λ” λ°©μ‹
- μ¥μ 
    1. μ½”λ“ μλ™ μ™„μ„± κΈ°λ¥ μ‚¬μ© κ°€λ¥
    2. λ¬Έλ²• μ¤λ¥ κ²€μ‚¬ κ°€λ¥
    3. λ™μ  μΏΌλ¦¬ μƒμ„± κ°€λ¥

- μμ‹
    ```
    JPAQuery<Product> query = new JPAQuery(entityManager); // QueryDSLμ‚¬μ©μ„ μ„ν• κ°μ²΄ μƒμ„±
    QProduct qProduct = QProduct.product;
    // λΉλ” ν•μ‹μ μΏΌλ¦¬ μ‘μ„±
    List<Product> productList = query
            .from(qProduct)
            .where(qProduct.name.eq("ν"))
            .orderBy(qProduct.price.asc())
            .fetch();
    ```